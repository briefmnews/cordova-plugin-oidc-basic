# Cordova Plugin OpenID Connect (OIDC) Basic

## Dependencies
This plugin aims to be a thin wrapper around the following libraries/APIs:
- iOS -- [AppAuth-iOS](https://github.com/openid/AppAuth-iOS)
- Windows -- The [Web Authentication Broker](https://docs.microsoft.com/en-us/uwp/api/Windows.Security.Authentication.Web.WebAuthenticationBroker) API. TODO: Preferrably will switch to [IdentityModel.OidcClient](https://github.com/IdentityModel/IdentityModel.OidcClient). Investigating supported UWP versions...
- Android -- TODO...

## Usage
```js
var req = {
    configuration: {
        authorizationEndpoint: "https://my-authorization-endpoint/authorize"
    },
    clientID: "my-client-id",
    scope: "openid",
    state: "my-state", // or leave absent and the plugin will generate random state by default
    redirectURL: "my-redirect-url", // see notes on redirectURL below
    responseType: "code" // authorization code flow
};
// Initiate authorization request
cordova.plugins.oidc.basic.presentAuthorizationRequest(req,
    function (resp) {
        // Success
        // Send following response info to server to perform the token exchange:
        // resp.authorizationCode -- The authorization code
        // resp.request.nonce -- The nonce. Generated by the plugin (currently no option to pass in or disable).
        // resp.request.codeVerifier -- The codeVerifier. Generated by the plugin (currently no option to pass in or disable PKCE).
    },
    function (err) {
        // Error. Inspect err.oidcType to see what kind. See below for more on errors and error types.
        // Example of handling a specific error type:
        if (err.oidcType === cordova.plugins.oidc.basic.ErrorType.USER_CANCELLED) {
            // User cancelled the authorizationr request
        }
        // Can handle other error types as needed
    }
);
```

## Supported flows
TODO... Primarily authorization code flow. Implicit should work too but not heavily tested. Currently
no support for performing a separate token exchange on device. Either need a server to do the token
exchange or need to do implicit flow.

## Configuring the redirectURL
TODO...

## Errors

#### Error types
All error types are available via `cordova.plugins.oidc.basic.ErrorType`. Explanation of types:
- `cordova.plugins.oidc.basic.ErrorType.UNSENDABLE_REQUEST` -- The calling code did something wrong,
e.g. passed an invalid authorization request, such that the request couldn't even be sent to the
authorization server.
- `cordova.plugins.oidc.basic.ErrorType.ERROR_RESPONSE` -- The authorization server returned an error
response as specified in https://tools.ietf.org/html/rfc6749#section-4.1.2.1.
- `cordova.plugins.oidc.basic.ErrorType.INVALID_RESPONSE` -- The authorization server returned an
invalid response not in keeping w/ the OpenID Connect spec.
- `cordova.plugins.oidc.basic.ErrorType.HTTP_ERROR` -- There was an HTTP error completing the
authorization request.
- `cordova.plugins.oidc.basic.ErrorType.USER_CANCELLED` -- The user cancelled the authorization
request.
- `cordova.plugins.oidc.basic.ErrorType.UNEXPECTED_ERROR` -- There was an unexpected error completing
the authorization request.

#### Error interface
All errors passed to the provided error callback are normal JS `Error`s extended w/ the following properties:
- `oidcType` String. One of the `cordova.plugins.oidc.basic.ErrorType` values.
- `oidcDetails` String. Additional details about the error.
- `oidcResponse` Object. Optional. If applicable, the error response from the authorization server.

## TODO: Fuller API description
